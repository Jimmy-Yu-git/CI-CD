(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{122:function(e,n,t){},168:function(e,n,t){},251:function(e,n,t){"use strict";t.r(n);var a,c,r,s,o,i=t(0),l=t.n(i),b=t(29),u=t.n(b),j=(t(167),t(168),t(33)),d=(t(122),t(268)),m=t(276),g=t(13),O=function(e){var n=e.me,t=e.setMe,a=e.setSignIn,c=e.displayStatus;return Object(g.jsxs)(g.Fragment,{children:[Object(g.jsx)("div",{className:"App-title",children:Object(g.jsx)("h1",{children:"My Chat Room"})}),Object(g.jsx)(d.a.Search,{prefix:Object(g.jsx)(m.a,{}),value:n,enterButton:"Sign In",onChange:function(e){return t(e.target.value)},placeholder:"Enter your name",size:"large",style:{width:300,margin:50},onSearch:function(e){e?(c({type:"success",msg:"success"}),a(!0)):c({type:"error",msg:"Missing user name"})}})]})},h=t(130),f=t(131),p=t(264),y=t(271),x=function(e){var n=e.visible,t=e.onCreate,a=e.onCancel,c=p.a.useForm(),r=Object(j.a)(c,1)[0];return Object(g.jsx)(y.a,{visible:n,title:"Create a new chat room",okText:"Create",cancelText:"Cancel",onCancel:a,onOk:function(){r.validateFields().then((function(e){r.resetFields(),t(e)})).catch((function(e){window.alert(e)}))},children:Object(g.jsx)(p.a,{form:r,layout:"vertical",name:"form_in_modal",children:Object(g.jsx)(p.a.Item,{name:"name",label:"Name",rules:[{required:!0,message:"Error: Please enter the name of the person to chat!"}],children:Object(g.jsx)(d.a,{})})})})},v=t(274),S=t(272),k=t(265),C=t(273),$=t(44),w=t(266),E=Object(w.a)(a||(a=Object($.a)(["\nmutation\n    createChatBox( $name1:String,$name2:String){\n        createChatBox(name1:$name1,name2:$name2){\n            _id\n          name\n          messages{\n                body\n                sender{\n              name\n            }\n            }\n        }\n    }\n\n    \n"]))),F=Object(w.a)(c||(c=Object($.a)(["\nmutation\n    createMessage( $key:String,$body:String,$me:String){\n        createMessage(key:$key,body:$body,me:$me){\n            body\n            sender{\n              name\n            }\n        }\n    }\n\n    \n"]))),M=Object(w.a)(r||(r=Object($.a)(["\nquery\n    chatbox( $name1:String,$name2:String){\n        chatbox(name1:$name1,name2:$name2){\n          name\n          messages{\n                body\n                sender{\n              name\n            }\n            }\n        }\n    }\n\n    \n"]))),I=(Object(w.a)(s||(s=Object($.a)(["\nsubscription \n    message ($name1:String,$name2:String) {\n        message (name1:$name1,name2:$name2){\n            mutation\n            data {\n                body\n                sender{\n                  name\n                }             \n            }\n\n        }\n     \n    }\n\n"]))),Object(w.a)(o||(o=Object($.a)(["\n  subscription {\n    allmessage {\n        mutation\n        data {\n            body\n            sender{\n              name\n            }             \n        }\n    }\n  }\n"])))),A=k.a.TabPane,B=function(e){var n=e.me,t=e.displayStatus,a=Object(i.useState)(""),c=Object(j.a)(a,2),r=c[0],s=c[1],o=Object(i.useState)(""),l=Object(j.a)(o,2),b=l[0],u=l[1],m=Object(i.useState)(!1),O=Object(j.a)(m,2),p=(O[0],O[1]),y=Object(i.useState)(""),$=Object(j.a)(y,2),w=$[0],B=$[1],L=Object(i.useState)([]),N=Object(j.a)(L,2),P=N[0],T=N[1],_=Object(i.useState)(!1),q=Object(j.a)(_,2),D=q[0],R=q[1],J=Object(i.useState)(""),z=Object(j.a)(J,2),G=z[0],K=z[1];console.log(G);var Q,U,H,V=Object(v.a)(E),W=Object(j.a)(V,1)[0],X=Object(v.a)(F),Y=Object(j.a)(X,1)[0];Object(i.useEffect)((function(){console.log("active"),console.log(G),G&&(console.log(G),Q=G.split("_"),console.log(Q),Q[0]===n?(U=Q[0],H=Q[1]):(U=Q[1],H=Q[0]),s(U),u(H))}),[G]),console.log(b);var Z=Object(S.a)(M,{variables:{name1:r,name2:b}}),ee=(Z.loading,Z.error,Z.data),ne=Z.subscribeToMore;console.log(ee),"undefined"===typeof ee&&console.log("111"),Object(i.useEffect)((function(){console.log("11"),ne({document:I,updateQuery:function(e,n){var t=n.subscriptionData;console.log("11");var a=t.data.allmessage.data;return Object(f.a)(Object(f.a)({},e),{},{chatbox:[].concat(Object(h.a)(e.chatbox.messages),[a])})}})}),[ne]);console.log("render"),console.log(P);return Object(g.jsxs)(g.Fragment,{children:[Object(g.jsx)("div",{className:"App-title",children:Object(g.jsxs)("h1",{children:[n,"'s Chat Room"]})}),Object(g.jsxs)("div",{className:"App-messages",children:[Object(g.jsx)(k.a,{type:"editable-card",activeKey:G,onChange:function(e){K(e),alert(e)},onEdit:function(e,n){"add"===n?R(!0):"remove"===n&&function(e,n){var t,a=n;P.forEach((function(n,a){n.key===e&&(t=a-1)}));var c=P.filter((function(n){return n.key!==e}));c.length?a===e&&(a=t>=0?c[t].key:c[0].key):a="",T(c),K(a)}(e,G)},children:P.map((function(e){var t=e.friend,a=e.key;e.chatLog;return Object(g.jsx)(A,{tab:t,closable:!0,children:"undefined"===typeof ee||null===ee.chatbox?Object(g.jsx)("p",{children:"Loading..."}):0===ee.chatbox.messages.length?Object(g.jsx)("p",{children:"NO MESSAGE.."}):ee.chatbox.messages.map((function(e,t){var a=e.sender,c=e.body;return a[0].name!==n?Object(g.jsxs)("p",{children:[Object(g.jsx)(C.a,{color:"blue",children:a[0].name}),":",c]}):Object(g.jsxs)("p",{style:{textAlign:"right"},children:[c,":",Object(g.jsx)(C.a,{color:"blue",children:a[0].name})]})}))},a)}))}),Object(g.jsx)(x,{visible:D,onCreate:function(e){!function(e,n){W({variables:{name1:n,name2:e}}),s(n),u(e);var t=[n,e].sort().join("_");if(console.log(t),P.some((function(e){return e.key===t})))throw new Error(e+"'s chat box has already opened.");var a=Object(h.a)(P);a.push({friend:e,key:t,chatLog:[]}),T(a),K(t),p(!0)}(e.name,n),R(!1)},onCancel:function(){R(!1)}})]}),Object(g.jsx)(d.a.Search,{value:w,onChange:function(e){return B(e.target.value)},enterButton:"Send",placeholder:"Enter message here...",onSearch:function(e){if(e){if(""===G)return t({type:"error",msg:"Please add a chatbox first."}),void B("");var a;a={key:G,body:e,sender:n},console.log(a),Y({variables:{key:a.key,body:a.body,me:a.sender}}),B("")}else t({type:"error",msg:"Please enter message."})}})]})},L=t(155),N="save-me",P=function(){var e=Object(i.useState)(!1),n=Object(j.a)(e,2),t=n[0],a=n[1],c=localStorage.getItem(N),r=Object(i.useState)(c||""),s=Object(j.a)(r,2),o=s[0],l=s[1],b=function(e){if(e.msg){var n=e.type,t={content:e.msg,duration:1};switch(n){case"success":L.b.success(t);break;case"error":default:L.b.error(t)}}};return Object(i.useEffect)((function(){t&&localStorage.setItem(N,o)}),[t]),Object(g.jsx)("div",{className:"App",children:t?Object(g.jsx)(B,{me:o,displayStatus:b}):Object(g.jsx)(O,{setMe:l,me:o,setSignIn:a,displayStatus:b})})},T=function(e){e&&e instanceof Function&&t.e(3).then(t.bind(null,277)).then((function(n){var t=n.getCLS,a=n.getFID,c=n.getFCP,r=n.getLCP,s=n.getTTFB;t(e),a(e),c(e),r(e),s(e)}))},_=t(269),q=t(267),D=t(270),R=t(263),J=t(111),z=t(152),G=t(66),K=new URL("/graphql",window.location.href),Q=new _.a({uri:K.href}),U=new z.a({uri:K.href.replace("http","ws"),options:{reconnect:!0}}),H=Object(J.b)((function(e){var n=e.query,t=Object(G.a)(n);return"OperationDefinition"===t.kind&&"subscription"===t.operation}),U,Q),V=new q.a({link:H,cache:(new D.a).restore({})});u.a.render(Object(g.jsx)(l.a.StrictMode,{children:Object(g.jsx)(R.a,{client:V,children:Object(g.jsx)(P,{})})}),document.getElementById("root")),T()}},[[251,1,2]]]);
//# sourceMappingURL=main.1f1ac20f.chunk.js.map